(()=>{"use strict";function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function n(e,n,a,f){var i=0,r="";a.stepAnimationDuration=parseInt(a.stepAnimationDuration);var o="yes"==n.find(".ff-step-container").attr("data-enable_step_data_persistency"),s=!1;o&&(s="yes"==n.find(".ff-step-container").attr("data-enable_step_page_resume"));var l=!!window.fluentFormVars.is_rtl,c=!1,d=function(t){var n=t.response,f=t.step_completed;jQuery.each(n,(function(t,n){if(n){var f=Object.prototype.toString.call(n);if("[object Object]"===f){var i=jQuery("[data-name=".concat(t,"]"));if(i.length&&"tabular-element"===i.attr("data-type"))jQuery.each(n,(function(n,a){var f=jQuery('[name="'.concat(t,"[").concat(n,']\\[\\]"]'));f.length||(f=jQuery('[name="'.concat(t,"[").concat(n,']"]'))),jQuery.each(f,(function(t,n){var f=e(n).val();-1===jQuery.inArray(f,a)&&f!==a||e(n).prop("checked",!0).change()}))}));else if("chained-select"===i.attr("data-type")){var r={meta_key:i.find("select:first").attr("data-meta_key"),form_id:i.closest("form").attr("data-form_id"),action:"fluentform_get_chained_select_options",filter_options:"all",keys:n};jQuery.getJSON(a.ajaxUrl,r).then((function(t){jQuery.each(t,(function(t,e){var a=i.find("select[data-key='".concat(t,"']"));0!=a.attr("data-index")&&jQuery.each(e,(function(t,e){a.append(jQuery("<option />",{value:e,text:e}))})),a.attr("disabled",!1).val(n[t])}))}))}else jQuery.each(n,(function(e,n){jQuery('[name="'.concat(t,"[").concat(e,']"]')).val(n).change()}))}else if("[object Array]"===f){var o=jQuery("[name=".concat(t,"]"));if("file"==(o=(o=o.length?o:jQuery("[data-name=".concat(t,"]"))).length?o:jQuery("[name=".concat(t,"\\[\\]]"))).attr("type"))h(o,n);else if(o.prop("multiple")){if(e.isFunction(window.Choices))o.data("choicesjs").setValue(n).change();else o.val(n).change()}else if("repeater_field"===o.attr("data-type")){var s=o.find("tbody"),l=o.attr("data-name");jQuery.each(n,(function(t,n){0!=t?s.find("tr:last").clone().appendTo(s).find(".ff-el-form-control").each((function(a,f){var i="ffrpt-"+(new Date).getTime()+a;e(f).val(n[a]),e(f).attr({id:i,name:"".concat(l,"[").concat(t,"][]"),value:n[a]}).change()})):s.find("tr:first .ff-el-form-control").each((function(t,a){e(a).val(n[t]).change()}))}))}else o.each((function(t,a){-1!=jQuery.inArray(e(a).val(),n)&&e(a).prop("checked",!0).change()}))}else{var c=jQuery("[name=".concat(t,"]"));if("radio"===c.prop("type")||"checkbox"===c.prop("type"))jQuery("[name=".concat(t,'][value="').concat(n,'"]')).prop("checked",!0).change();else{var d=c.closest(".ff-el-group").find(".fluentform-signature-pad");if(d.length){var u=d[0].getContext("2d"),p=new Image;p.src=n,p.onload=function(){u.drawImage(p,0,0)}}c.val(n).change()}}}})),c=!0,s&&v(f,a.stepAnimationDuration,!0),c=!1},u=function(t){if(n.find(".ff-el-progress").length){var f=t.totalSteps,i=t.activeStep,r=100/f*(i+1),o=n.find(".ff-el-progress-title li"),s=n.find(".ff-step-header .ff-el-progress-bar"),l=s.find("span");s.css({width:r+"%"}),r?s.append(l.text(parseInt(r)+"%")):l.empty();var c=a.step_text,d=e(o[i]).text();c=c.replace("%activeStep%",i+1).replace("%totalStep%",f).replace("%stepTitle%",d),n.find(".ff-el-progress-status").html(c),o.css("display","none"),e(o[i]).css("display","inline")}},p=function(t){e(document).on("keydown",f+" .fluentform-step > .step-nav button",(function(t){9==t.which&&"next"==e(this).data("action")&&t.preventDefault()})),e(f).on("click",".fluentform-step  .step-nav button, .fluentform-step  .step-nav img",(function(a){var f=e(this).data("action"),r="next",o=e(this).closest(".fluentform-step"),s=window.fluentFormApp(n);if("next"==f){try{var l=o.find(":input").not(":button").filter((function(t,n){return!e(n).closest(".has-conditions").hasClass("ff_excluded")}));l.length&&s.validate(l),i++}catch(a){if(!(a instanceof window.ffValidationError))throw a;return s.showErrorMessages(a.messages),void s.scrollToFirstError(350)}n.trigger("ff_to_next_page",i),jQuery(document).trigger("ff_to_next_page",{step:i,form:n});var c=n.find(".fluentform-step");n.trigger("ff_render_dynamic_smartcodes",e(c[i]))}else i--,r="prev",n.trigger("ff_to_prev_page",i),jQuery(document).trigger("ff_to_prev_page",{step:i,form:n});var d="yes"!=n.find(".ff-step-container").attr("data-disable_auto_focus");v(i,t,d,r)}))},v=function(a,s){var d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"next";e("div"+f+"_errors").empty(),i=a;var v=n.find(".ff-step-body"),h=n.find(".ff-step-titles li"),_=n.find(".fluentform-step"),g=_.length;n.offset().top,e("#wpadminbar");_.removeClass("active"),e(_[i]).addClass("active"),h.removeClass("ff_active ff_completed"),e.each(t(Array(i).keys()),(function(t){e(e(h[t])).addClass("ff_completed")})),e(h[i]).addClass("ff_active");var y=function(){if(!window.ff_disable_step_scroll){var t=n.find(".ff_step_start");if(window.ff_scroll_top_offset)var a=window.ff_scroll_top_offset;else a=t.offset().top-20;var f,i,r,o,l;(i=(f=t).offset().top,r=i+f.outerHeight(),o=e(window).scrollTop(),l=o+e(window).height(),r>o&&i<l)&&!window.ff_force_scroll||e("html, body").delay(s).animate({scrollTop:a},0)}},b={left:-100*i+"%"};l&&(b={right:-100*i+"%"}),v.animate(b,s,(function(){d&&y(),v.css({width:r})}));var w=0===i;if(o&&!c&!w&&m(n,i).then((function(t){console.log(t)})),u({activeStep:i,totalSteps:g}),_.last().hasClass("active"))n.find('button[type="submit"]').css("display","inline-block");else if(n.find('button[type="submit"]').css("display","none"),!window.ff_disable_auto_step){var x=0;n.find(".fluentform-step.active .ff_excluded").legth&&(x=50),setTimeout((function(){var t=n.find(".fluentform-step.active"),e=n.find(".fluentform-step.active > div").length-1,a=n.find(".fluentform-step.active > .ff_excluded").length;n.find(".fluentform-step.active > .ff-t-container").length&&(e-=n.find(".fluentform-step.active > .ff-t-container").length,e+=n.find(".fluentform-step.active > .ff-t-container > .ff-t-cell > div").length,a+=n.find(".fluentform-step.active > .ff-t-container > .ff-t-cell > .ff_excluded").length,n.find(".fluentform-step.active > .ff-t-container.ff_excluded").length&&(a-=n.find(".fluentform-step.active > .ff-t-container.ff_excluded").length,a-=n.find(".fluentform-step.active > .ff-t-container.ff_excluded > .ff-t-cell > .ff_excluded").length,a+=n.find(".fluentform-step.active > .ff-t-container.ff_excluded > .ff-t-cell > div").length)),e==a&&t.find(".step-nav button[data-action="+p+"]").click()}),x)}},m=function(t,n){var f=t.find(":input").filter((function(t,n){return!e(n).closest(".has-conditions").hasClass("ff_excluded")}));f.filter((function(t,n){var a=e(n);return a.parents().hasClass("ff_repeater_table")&&"select"==a.attr("type")&&!a.val()})).prepend("<option selected disabled />");var i=f.serialize();e.each(t.find("[type=file]"),(function(t,n){var a={},f=n.name+"[]";a[f]=[],e(n).closest("div").find(".ff-uploaded-list").find(".ff-upload-preview[data-src]").each((function(t,n){a[f][t]=e(this).data("src")})),e.each(a,(function(t,n){if(n.length){var a={};a[t]=n,i+="&"+e.param(a),!0}}))}));var r={active_step:n,data:i,form_id:t.data("form_id"),action:"fluentform_step_form_save_data"};return jQuery.post(a.ajaxUrl,r)},h=function(t,n){var f=t.closest(".ff-el-input--content").find(".ff-uploaded-list");e.each(n,(function(t,n){var i=e("<div/>",{class:"ff-upload-preview","data-src":n,style:"border: 1px solid rgb(111, 117, 125)"}),r=e("<div/>",{class:"ff-upload-thumb"});r.append(e("<div/>",{class:"ff-upload-preview-img",style:"background-image: url('".concat(_(n),"');")}));var o=e("<div/>",{class:"ff-upload-details"}),s=e("<span/>",{html:a.upload_completed_txt,class:"ff-upload-progress-inline-text ff-inline-block"}),l=e("<div/>",{class:"ff-upload-filename",html:n.substring(n.lastIndexOf("/")+1)}),c=e('\n\t\t\t\t\t\t\t\t\t<div class="ff-upload-progress-inline ff-el-progress">\n\t\t\t\t\t\t\t\t\t\t<div style="width: 100%;" class="ff-el-progress-bar"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t'),d=e("<span/>",{"data-href":"#",html:"&times;",class:"ff-upload-remove"}),u=e("<div>",{class:"ff-upload-filesize ff-inline-block",html:""}),p=e("<div>",{class:"ff-upload-error",style:"color:red;"});o.append(l,c,s,u,p,d),i.append(r,o),f.append(i)})),t.trigger("change_remaining",-n.length),t.trigger("change")},_=function(t){var e=t.split(/[#?]/)[0].split(".").pop().trim().toLowerCase();if(-1!=["jpg","jpeg","gif","png"].indexOf(e))return t;var n=document.createElement("canvas");n.width=60,n.height=60,n.style.zIndex=8,n.style.position="absolute",n.style.border="1px solid";var a=n.getContext("2d");return a.fillStyle="rgba(0, 0, 0, 0.2)",a.fillRect(0,0,60,60),a.font="13px Arial",a.fillStyle="white",a.textAlign="center",a.fillText(e,30,30,60),n.toDataURL()};return{init:function(){var t,f,s,l;o&&jQuery(document).ready((function(t){jQuery.getJSON(a.ajaxUrl,{form_id:n.data("form_id"),action:"fluentform_step_form_get_data"}).then((function(t){t&&d(t)}))})),n.find(".fluentform-step:first").find('.step-nav [data-action="prev"]').remove(),t=n.find(".ff-step-body"),f=n.find(".fluentform-step"),s=f.length,l=n.find(".ff-step-titles li"),r=100*s+"%",t.css({width:r}),f.css({width:100/s+"%"}),e(f[i]).addClass("active"),e(l[i]).addClass("active"),f.length&&!f.last().hasClass("active")&&n.find('button[type="submit"]').css("display","none"),u({activeStep:i,totalSteps:s}),p(a.stepAnimationDuration),function(){function t(t){if(1==t.closest(".fluentform-step.active").find(".ff-el-group:not(.ff_excluded):not(.ff-custom_html)").length)if(t.closest(".fluentform-step.active").find(".ff_excluded").length){var e=window.ffTransitionTimeOut||400;setTimeout((function(){t.closest(".fluentform-step.active").find(".ff-btn-next").trigger("click")}),e)}else t.closest(".fluentform-step.active").find(".ff-btn-next").trigger("click")}"yes"==n.find(".ff-step-container").attr("data-enable_auto_slider")&&(n.find(".ff-el-form-check-radio,.ff-el-net-label, .ff-el-ratings label").on("click",(function(){t(e(this))})),n.find("select").on("change",(function(){t(e(this))})))}()},updateSlider:v,populateFormDataAndSetActiveStep:d}}var a;(a=jQuery)(document.body).on("fluentform_init",(function(t,e,f){var i="."+f.form_instance,r=-1,o="no";if(a(i).hasClass("ff-form-has-save-progress")){a(i).hasClass("ff-form-has-steps")&&(e.on("ff_to_next_page",(function(t,e){o=e})),e.on("ff_to_prev_page",(function(t,e){o=e}))),a(i).on("click",".ff-btn-save-progress",(function(t){var n=this;t.preventDefault();var f=e.find(":input").filter((function(t,e){return!a(e).closest(".has-conditions").hasClass("ff_excluded")}));f.filter((function(t,e){var n=a(e);return n.parents().hasClass("ff_repeater_table")&&"select"==n.attr("type")&&!n.val()})).prepend("<option selected disabled />");var i=f.serialize();a.each(e.find("[type=file]"),(function(t,e){var n={},f=e.name+"[]";n[f]=[],a(e).closest("div").find(".ff-uploaded-list").find(".ff-upload-preview[data-src]").each((function(t,e){n[f][t]=a(this).data("src")})),a.each(n,(function(t,e){if(e.length){var n={};n[t]=e,i+="&"+a.param(n)}}))}));var s={source_url:window.form_state_save_vars.source_url,action:"fluentform_save_form_progress_with_link",data:i,form_id:e.data("form_id"),hash:r,active_step:o};jQuery.post(fluentFormVars.ajaxUrl,s).then((function(t){if(t){r=t.data.hash;var f=e.find(".ff-saved-state-link");if(f.length)return void f.find("input").val(t.data.saved_url);var i='<div class="ff-el-input--content"><input readonly value="'.concat(t.data.saved_url,'" class="ff-el-form-control" ></div>'),o=a("<div/>",{class:"ff-el-group ff-saved-state-link",html:'<div class="ff-el-input--label"><label>Copy Link</label></div>'+i});a(n).closest(".ff-el-group").after(o)}}))}));var s=!1;void 0!==window.form_state_save_vars&&(s=window.form_state_save_vars.key),s&&(e.append('<input type="hidden" value="'.concat(s,'" class="__fluent_state_hash" name="__fluent_state_hash"/>')),jQuery.getJSON(fluentFormVars.ajaxUrl,{form_id:e.data("form_id"),action:"fluentform_get_form_state",hash:s}).then((function(t){t&&n(a,e,window.fluentFormVars,i).populateFormDataAndSetActiveStep(t)})))}}))})();