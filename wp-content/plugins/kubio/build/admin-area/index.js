this.kubio=this.kubio||{},this.kubio.adminArea=function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=594)}({1:function(t,e){!function(){t.exports=this.wp.i18n}()},2:function(t,e){!function(){t.exports=this.lodash}()},33:function(t,e){!function(){t.exports=this.wp.url}()},57:function(t,e){!function(){t.exports=this.jQuery}()},594:function(t,e,n){"use strict";n.r(e),n.d(e,"initDemoImport",(function(){return M}));var i=n(2);let a={},o={};const s="ACTIVE",r="INSTALLED",l="NOT_INSTALLED",c=()=>o.slug||0,d=()=>o.name,u=()=>{var t;return(null===(t=o)||void 0===t?void 0:t.plugins)||[]},p=()=>o.thumb,f=()=>!o.is_pro,b=t=>{const e=Object(i.find)(a.demos,{slug:t});o=e},g=()=>a.ajax_nonce,m=t=>{var e;return(null===(e=a.texts)||void 0===e?void 0:e[t])||""},h=t=>a.plugins_states[t]||l,w=t=>a.texts.plugins_states[h(t)],k=()=>a.kubio_pro_active;var v=n(57),y=n(1),_=n(33);const O=t=>new Promise(((e,n)=>{const o=t instanceof window.FormData?t:new window.FormData;o.append("nonce",g()),Object(i.each)(t,((t,e)=>o.append(e,t))),v.ajax({method:"POST",url:Object(_.addQueryArgs)(a.ajax_url,{nonce:g(),action:o.get("action")}),data:o,contentType:!1,processData:!1}).done((t=>{if(!1===t.success){var i,a;const e=(null==t||null===(i=t.data)||void 0===i?void 0:i.error_message)||(null==t||null===(a=t.data)||void 0===a?void 0:a.error);n(e)}else e(t)})).fail((t=>{n(`${t.status} ( ${t.statusText} ) : ${t.responseText}`)}))})),j=async t=>await O({action:"kubio-demo-site-activate-plugin",slug:t}),x=async t=>{const e=h(t);try{switch(e){case s:return!0;case r:await j(t);break;case l:await(async t=>await O({action:"kubio-demo-site-install-plugin",slug:t}))(t),await j(t)}}catch(t){throw t}},P=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={action:"kubio-demo-site-import-data",slug:c(),first_call:!0};try{let n={};do{if(t&&e.first_call?(Object(i.each)(e,((e,n)=>t.append(n,e))),n=await O(t)):n=await O(e),e=Object(i.omit)(e,"first_call"),n.before_import_action?(D(R.PREPARING,A.PROGRESS),e={...e,before_import_action:n.before_import_action}):(D(R.PREPARING,A.DONE),D(R.CONTENT,A.PROGRESS),e=Object(i.omit)(e,"before_import_action")),"finished"===n.status){D(R.CONTENT,A.DONE);break}}while("requires-new-ajax-call"===n.status)}catch(t){U(t)}};let E=0;const N=t=>{const e=v("#kubio-template-installing"),n=e.find("#import-button"),i=e.find("[data-available-pro-only]"),a=e.find("[data-check-pro-features]");t?(i.addClass("hidden"),a.addClass("hidden"),n.attr("data-start-import",""),n.show()):(n.removeAttr("data-start-import"),n.hide(),i.removeClass("hidden"),a.removeClass("hidden"))},S=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=v("#kubio-templates-list"),n=v("#kubio-template-installing");if(t){E=window.scrollY,e.hide(),n.css("display","flex").hide().fadeIn(100),n.find("img").attr("src",p());const t=Object(y.sprintf)(m("importing_template"),d());n.find("[data-title]").html(t);const i=u(),a=n.find("[data-plugins]"),o=n.find("[data-plugins-list]");i.length?(a.show(),o.empty(),i.forEach((t=>{const e=w(t.slug);o.append(`<li><span>${t.label}</span><span>${e}</span></li>`)}))):a.hide();const s=f(),r=k();N(!(!r&&!s))}else n.css("display","flex").hide(),v("#kubio-templates-list").show(),setTimeout((()=>window.scrollTo(0,E)),5)},T=async()=>{v(".kubio-admin-page-header-start-editing").addClass("hidden");const t=v("#kubio-template-installing"),e=t.find("[data-info]"),n=t.find("[data-progress]"),i=t.find("[data-install-buttons]"),a=t.find("[data-install-success-buttons]"),o=v(".kubio-progress-bar");e.hide(),n.css("display","flex").show(),i.hide(),o.show();try{await(async()=>{try{D(R.PLUGINS,A.PROGRESS);const t=u();for(let e=0;e<t.length;e++){const{slug:n}=t[e];await x(n)}D(R.PLUGINS,A.DONE)}catch(t){U(t)}})(),await P()}catch(t){U()}o.hide(),a.show(),v(".kubio-admin-page-header-start-editing").removeClass("hidden")};const C=()=>{v((()=>{!function(){try{const t=new URL(location).searchParams.get("import");if(!t)return;b(t),S(),T()}catch(t){console.error(t)}}(),v(document).on("click","#kubio-templates-list button[data-slug]",(function(){const t=v(this).data("slug");b(t),S()})),v(document).on("click","#kubio-template-installing button[data-cancel-import]",(function(){S(!1)})),v(document).on("click","#kubio-template-installing button[data-start-import]",T),v(document).on("submit","#kubio-import-demo-site",(async t=>{t.preventDefault(),t.stopPropagation();const e=t.target,n=new window.FormData(e);L=!0;const i=v(e).siblings(".kubio-progress-bar");i.show(),v(e).hide();try{await P(n)}catch(t){i.hide();const e=G(t);v("[data-kubio-manual-demo-site-errors]").append(`<div class="kubio-demo-site-manual-import-error">${e}</div>`)}i.hide()}))}))},R={PLUGINS:"plugins",PREPARING:"preparing",CONTENT:"content"},I={plugins:"data-installing-plugins",preparing:"data-preparing-for-import",content:"data-importing-content"},A={INACTIVE:"",PROGRESS:"progress",DONE:"active"},D=(t,e)=>{v(`[data-progress-list] [${I[t]}]`).attr("class",e)};let L=!1;const G=t=>{t=Object(i.castArray)(t);let e="";return t.forEach((t=>e+=`<p>${t}</p>`)),e},$=t=>{if(L)return;const e="[data-importing-errors]";v(e).show(),(t=Object(i.castArray)(t)).forEach((t=>v(`${e} [data-importing-errors-content]`).append(`<p>${t}</p>`)))},U=t=>{throw L||($(t),$(m("import_stopped")),L=!0),v(".kubio-progress-bar").hide(),v("[data-progress-list] li").attr("class",""),t},M=t=>{a=t,C()},F=v("#upgrade_to_pro_wrapper #kubio-page-builder-activate-license-form");let K=F;const Q=v(".notice #kubio-page-builder-activate-license-form");Q.length&&(K=Q);const q=v("#kubio-page-builder-check-license form");if(q.length&&(K=q),K.length){const t=K.find("input[type=text]"),e=K.parent(),n=e.find("#kubio-page-builder-activate-license-message"),i=e.find(".description"),a=e.find(".spinner-holder");function o(t){const e=jQuery(document.createElement("div")).append(t);return e.find("input,button,script,style").remove(),e.find("body").length?e.find("body").html():e.html()}function s(){n.hide()}function r(t){c(),n.attr("class","message error-message"),n.html(o(t)),n.show()}function l(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";K.hide(),n.hide(),i.hide(),a.show(),""!==t&&("loader"===t?(a.removeClass("ok"),a.find(".icon .loader").show()):"ok"===t&&a.addClass("ok")),""!==e&&a.find(".message").text(e)}function c(){K.show(),n.show(),i.show(),a.hide()}t.on("keyup change",s),K.on("submit",(function(e){e.preventDefault(),e.stopPropagation();const n=t.val();n?(s(),l("loader",Object(y.__)("Loading…","kubio")),K.addClass("disabled"),wp.ajax.send("kubiowp-page-builder-activate",{data:{key:n}}).done((function(t){F.length?(l("loader",Object(y.__)("Installing Kubio PRO…","kubio")),wp.ajax.post("kubiowp-page-builder-maybe-install-pro").done((function(){l("ok",Object(y.__)("Kubio PRO sucessfully installed","kubio"))})).fail((function(t){t.message?r(t.message):r(Object(y.__)("There was an error installing the Kubio PRO plugin","kubio"))}))):l("ok",t||Object(y.__)("Activated successfully","kubio"))})).fail((function(t){c(),K.removeClass("disabled"),r(t.responseJSON.data)}))):r(Object(y.__)("License key is empty","kubio"))})),q.length&&window.wp&&window.wp.ajax&&wp.ajax.send("kubiowp-page-builder-check-license").fail((function(t){K.closest(".notice").removeClass("hidden"),r(o(t.responseJSON.data))}))}const J=v("#adminmenu .toplevel_page_kubio");if(J.length){const t=window.location.search,e=new URLSearchParams(t);if("kubio-get-started"===e.get("page")){const t=e.get("tab");null!==t&&(J.find("li.current").removeClass("current"),J.find("a[href*='tab="+t+"']").length?J.find("a[href*='tab="+t+"']").closest("li").addClass("current"):J.find("li.wp-first-item").next().addClass("current"))}J.find("a[href*='tab=pro-upgrade']").length&&J.find("a[href*='tab=pro-upgrade']").closest("li").addClass("li-pro-upgrade")}setTimeout((()=>{v(".kubio-admin-page-page-section").eq(0).append(v(".kubio-admin-row.get-started-imported"))}),100)}});
